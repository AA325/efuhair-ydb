ZAA02GFAXR ;PG&A,ZAA02G-FAX,1.36,STATUS SCREEN; 07SEP91  19:35;20JAN94 2:05P
 ;Copyright (C) 1991-1994, Patterson, Gray and Associates Inc.
 ;
POP S LE=2,WD=78,IP="4,8,14,11,11,5,5,3",Y="Job#\Status\Fax #\Queue Time\Fax Time\Usage\Pgs",PX="P3A" S:'$D(NX) NX=12,BL=22 S:'$D(EX) EX="I Y]"""",$P(Y,""\"")'=ZAA02G(3)"
POP1 S XC="F %C=",NE=$L(IP,","),D=LE F J=1:1:NE-1 S D=D+$P(IP,",",J)+1,XC=XC_D_","
 S XC=$E(XC,1,$L(XC)-1)_" X D",%R=NX-1,%C=LE,B="",$P(B,ZAA02G("HL"),WD-1)="",D="W @ZAA02GP,ZAA02G(""TI"")" W @ZAA02GP,ZAA02G("RON"),ZAA02G("LO"),ZAA02G("L"),@ZAA02GP,ZAA02G("G1"),ZAA02G("TLC"),B,ZAA02G("TRC") X XC
 S %C=LE,%R=%R+1 W @ZAA02GP,ZAA02G("VL"),ZAA02G("G0") F J=1:1:NE S D=$P(Y,"\",J),L=$P(IP,",",J),M=L+$L(D)\2 W $J(D,M),$J("",L-M),ZAA02G("G1"),ZAA02G("VL"),ZAA02G("G0")
 S %R=%R+1,D="W @ZAA02GP,ZAA02G(""X"")" W @ZAA02GP,ZAA02G("G1"),ZAA02G("LI"),B,ZAA02G("RI") X XC
 S SR=%R,PG=1,PG(PG)="",P="" D P2
 S %R=%R+1,D="W @ZAA02GP,ZAA02G(""BI"")" W @ZAA02GP,ZAA02G("G1"),ZAA02G("BLC"),B,ZAA02G("BRC") X XC
 I $D(SEL),SEL="Q" K NE,SE,PG,IP,WD,SEL Q
 W ZAA02G("G0") X ^ZAA02G("ECHO-OFF")
P1 I '$D(SEL) S %C=1,%R=24 W @ZAA02GP R A:10 I '$T S P=PG(PG) G P4
 I $D(SEL) S %R=SE(SEL),%C=LE+20,D=$J($P(^ZAA02GFAXQ("DIR",SEL(SEL)),"\",4),14) W @ZAA02GP,ZAA02G("ROF"),D R A#1 W @ZAA02GP,ZAA02G("RON"),D
 X ZAA02G("T") S ZF=$P(^ZAA02G(.3),"\",$A(^ZAA02G(.3,ZAA02G,0),$F(^(0),ZF))+2) I A="","CR,EX"[ZF W ZAA02G("ROF") X ^ZAA02G("ECHO-ON") K NE,SE,PG,IP,WD  Q
 I ZF="PU" G P1:PG=1 S PG=PG-1,P=PG(PG) G P4
 I ZF="PD" G P1:Y="" S PG=PG+1,PG(PG)=P G P4
 I ZF="SE" D SELECT G POP
 G P1:'$D(SEL) I ZF="DK"!(A=" ") S SEL=SEL+1 S:SEL=SE SEL=1 G P1
 I ZF="UK" S SEL=SEL-1 S:SEL=0 SEL=SE-1 G P1
 G P1
P4 S %R=SR D P2 G P1
 ;
P2 W ZAA02G("G0") K SE S %C=LE,SE=1 F %R=%R+1:1:BL-1 W @ZAA02GP,ZAA02G("G1"),ZAA02G("VL"),ZAA02G("G0") D P3
 Q
P3 S Y="" S:$O(^ZAA02GFAXQ("DIR",P))]"" P=$O(^(P)),Y=^(P) X EX G:$T P3 I $D(SEL),SEL'="Q" S SEL=1,SE(SE)=%R,SEL(SE)=P,SE=SE+1
 D @PX Q
P3A F J=1:1:NE S L=$P(IP,",",J),D=$E($P(Y,"\",$P("1,3,4,6,7,8,16,14",",",J)),1,L),D=$S(J=7:D=D-$P(Y,"\",15),J=1:10000-P,1:D) W:13[J $J(D,L) W:13'[J D,$J("",L-$L(D)) W ZAA02G("G1"),ZAA02G("VL"),ZAA02G("G0")
 Q
SEL S SEL=1,EX="I 0" D POP S X=SEL(SEL) K SEL Q
SELECT S Y="40\CRHLUD\1\Status Options\\Show All,Personal Listing,Errors only",%R=BL-10,Y(0)="\EX" D ^ZAA02GWPVJ Q:X["EX"
 S EX=$S(X=1:"I 0",X=2:"",X=3:"I Y]"""",$P(Y,""\"",3)'[""ERR""",1:"") K:EX="" EX Q
 ;
ERR 
 ;
TLINE S Y="18,10\RHLW\1\"_$P(Y,"\")_"\\*,"_$P(Y,"\",2)_"*,*,"_$J("",39) D ^ZAA02GFAXU2 S %C=20 W @ZAA02GP,$J("",40) S X=EV\40,Y=1
 S:X<1 X=1,Y=40/EV S XX="S EV=EI\1,EI=EI+"_Y_",EV=EI-EV I EV>1 W ZAA02G(""RON""),$J("""",EV),ZAA02G(""ROF"")",EI=0 W ZAA02G("LO"),@ZAA02GP,ZAA02G("RON")," ",ZAA02G("ROF")
 Q
TT S EV=39,T=EV,Y="WAIT\THIS MAY TAKE A WHILE" D TLINE F J=1:1:T X XX R CC
