ZAA02GSCMRC ;PG&A,ZAA02G-MTS,1.20,REPORT CODE EDIT;05JAN94  01:03;;;17APR2006  10:29
 ;Copyright (C) 1995, Patterson, Gray and Associates Inc.
 ;
CODE N (ZAA02GSCMD,ZAA02GSCM,ZAA02G,ZAA02GP,SCr,L) S C1=$P(@ZAA02GSCMD@("XDIR",SCr,1,L),","),C2=$G(@ZAA02GSCMD@("DICT",3,C1))
 S LEX="ORG" I $D(@ZAA02GSCM@("PARAM","LEX")) S LEX=^("LEX")
ENTR2 S (OTEXT,OTEXTI)=" " I 'C2 S CODE=C1
 I C2 S C3=$P(C2,",",2),BCODE=$G(@ZAA02GSCMD@("DICT",1,+C2,C3)),OTEXT=$G(^(C3,LEX,1)),OTEXTI=$G(^(2)),DESC=$P(BCODE,"^",2),CODE=$P(BCODE,"^",4),BCODE=$P(BCODE,"^",3)
 S %=OTEXT,T="TEXT" D FORMAT S %=OTEXTI,T="TEXTI" D FORMAT
 X ZAA02G("ECHO-ON") S SCR="ZAA02GSCM",SNL=9,ZAA02Gform="0;;;N" D ^ZAA02GFORM X ^ZAA02G("ECHO-OFF")
 S TEXT="" F J=1:1:4 S %=$G(TEXT(J)) S:%]"" TEXT=TEXT_" "_%
 S TEXT=$E(TEXT,2,255),TEXTI="" F J=1:1:3 S %=$G(TEXTI(J)) S:%]"" TEXTI=TEXTI_" "_%
 S TEXTI=$E(TEXTI,2,255) I OTEXT=TEXT&(OTEXTI=TEXTI) G CLR
 S Y="25,8\RHLD\1\\\Text has changed*,*,Do you want to save the changes?*,*,Yes,No" D ^ZAA02GPOP G CLR:X'=5
 S @ZAA02GSCMD@("DICT",1,+C2,C3,LEX,1)=TEXT,^(2)=TEXTI
CLR S %C=7 F %R=6:1:19 W @ZAA02GP,$J("",69)
 X ^ZAA02G("ECHO-OFF") Q
 ;
FORMAT S I=$TR(%," ",""),I=$E(I,$L(I)),%=$E(%,1,$L($P(%,I,1,$L(%,I)-1)_I))_" "
 F J=1:1:4 S L=$L($E(%,1,63)," ")-1,L=$L($P(%," ",1,'L+L))+1,@T@(J)=$E(%,1,L-1),%=$E(%,1+L,255)
 Q
ENTRY N (ZAA02GSCMD,ZAA02GSCM,ZAA02G,ZAA02GP,C1,C2) S LEX="ORG" G ENTR2
