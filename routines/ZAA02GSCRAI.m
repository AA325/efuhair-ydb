ZAA02GSCRAI ;PG&A,ZAA02G-SCRIPT,2.10,ADS ACCOUNT INQUIRY;07NOV94  21:23;;;Tue, 20 Aug 2013  15:46
C ;Copyright (C) 1991, Patterson, Gray & Associates, Inc.
 N:1 (ZAA02G,ZAA02GP,K,K1,TOPP,CLN,CDOC) S OLDK=K S:$G(K1)>1 K=K_"/"_K1 S:'$D(TOPP) TOPP=9
 I $D(ZAA02G("ECHO-ON"))+$D(XX)'=2 S:$D(ZAA02G)>2 ZAA02G=$G(^ZAA02G($I)) D SETUP^ZAA02GWP
 S ZAA02G("MENU")=0 I '$D(ZAA02GSCR) S ZAA02GSCR=$S($G(^ZAA02GSCR("PARAM","DATABASE"))]"":^("DATABASE"),1:"^ZAA02GSCR")
 S $P(ZAA02GSCRP,";",3)=$S($G(@ZAA02GSCR@("PARAM","LOOKUP"))]"":^("LOOKUP"),$D(^VA):1,$D(^RFG):2,$D(^MIDIC):3,1:0) ; VA=1,ADS=2,MIDS=3
DIS S A="" F J=1:1:99 S A=$O(^ZAA02GACT(K,"TRANS",A)) Q:A=""  I $D(@ZAA02GSCR@("TRANS",A))+$D(@ZAA02GSCR@("DIR",99,10000000-A))=0 K ^ZAA02GACT(K,"TRANS",A)
 S A="" F J=1:1:99 S A=$O(^ZAA02GACT(K,"TRANS",A)) Q:A=""  I $D(@ZAA02GSCR@("TRANS",A,.011))#2,$P(^(.011),"`",9)'=K,$L($P(^(.011),"`",9))<9 K ^ZAA02GACT(K,"TRANS",A) ; 9 DIGIT CODE FOR NEW ROCHELLE
 S ID=K,TL=TOPP+1,BL=22 I $D(^ZAA02GACT(K)),$D(^ZAA02GACT(K,"TRANS"))=0 D ^ZAA02GSCRAI2 S ZAA02GWPD="^ZAA02GWP(DIR,DOC)" G DIS2
 S TOP=TOPP,%R=TOP-1,%C=1,AST=0 W @ZAA02GP,ZAA02G("CL") D ACCT^ZAA02GSCRTR S ZAA02GWPD=ZAA02GSCR_"(""TRANS"",DOC)"
DIS1 Q:'$D(DOC)  I DOC="" S %R=TL+2,%C=1 W @ZAA02GP,ZAA02G("CS") G END
 S ZAA02GWPB=ZAA02GWPD I ZAA02GWPD["^ZAA02GSCR",$D(@ZAA02GWPD) S %R=TOPP-1,%C=2 ; W @ZAA02GP,ZAA02G("RON"),$E($TR(^(DOC),"`~","  "),1,79),ZAA02G("ROF")
 W @ZAA02GP,ZAA02G("CL")," ",ZAA02G("RON"),$$LEV4^ZAA02GSCRTR(j),ZAA02G("ROF") K II,SDIR
 I $D(@ZAA02GSCR@("TRANS",DOC))<11 D ARCH^ZAA02GSCRAT G END:DOC="",END:'$D(@ZAA02GSCR@("TRANS",DOC))
 ;
DIS2 S WO="",MG=76,NM=DOC,ZAA02GWPOPT="INQ,NC",HLPR="^ZAA02GSCRH" D ENTRY^ZAA02GSCRER
 I $D(^ZAA02GSCR("PARAM","ALT ZAA02G-VIEW MENU")) X ^("ALT ZAA02G-VIEW MENU")
 ;K NOFAX I $P($G(@ZAA02GWPD),"`",13)'=$TR($P($G(@ZAA02GWPD),"`",13),"EI") S NOFAX=1 ; IN ALT ZAA02G-VIEW MENU
 S Y=$S($D(^ZAA02GFAXC):4,1:10)_",24\UHP5\*\\\SELECT ANOTHER REPORT,PRINT REPORT,"_$S($D(^ZAA02GFAXC)&'$D(NOFAX):"FAX,",1:"")_"EXIT",Y(0)="\EX"
 S %R=24,%C=1 W @ZAA02GP,ZAA02G("CL") D ^ZAA02GPOP S:$D(OLDK) K=OLDK G END:X["EX",DIS:X=1,PRINT:X=2,FAX:X=3&(Y["FAX")
 ;
END S %R=TOPP-1,%C=1 W @ZAA02GP,ZAA02G("CS") L  S:$D(OLDK) K=OLDK X ^ZAA02G("TERM-OFF") Q
PRINT K DISTR I ZAA02GWPB["ZAA02GSCR" S INP("DIST")=$P($G(@ZAA02GWPB@(.011)),"`",15),INP("SITEC")=$P($G(^(.011)),"`",6) S:$D(@ZAA02GSCR@("PARAM","AI-DISTR")) DISTR=^("AI-DISTR") S PRINT=1 D PR1^ZAA02GSCRER2 K PRINT G END
 S %R=24,%C=30 W @ZAA02GP,*13,ZAA02G("CL"),@ZAA02GP,"Enter Printer - " R DV Q:DV=""  S DOC="^ZAA02GWP("""_DIR_""","_DOC_")" D QUEUE^ZAA02GWPP8 Q
FAX S ZAA02GWPD=ZAA02GWPB D FAXAI^ZAA02GSCRFX G END
 ;
T S K=123,TOPP=5 G ZAA02GSCRAI
