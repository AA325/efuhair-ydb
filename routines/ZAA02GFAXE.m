ZAA02GFAXE ;PG&A,ZAA02G-FAX,1.36,FAX EDITOR;17JUL92 12:37P;;;14JUL2005  11:14
 ;Copyright (C) 1991-1994, Patterson, Gray and Associates Inc.
 ;
BEG D INIT S %R=1,%C=20 W @ZAA02GP,"         F O N T     E D I T O R             ",ZAA02G("LO"),!!,ZAA02G("CS") S X=ZAA02G("HL"),$P(X,X,42)=""
 S %C=38 F R=32:16:255 S %R=3 W @ZAA02GP," ",$S(R>99:$E(R),1:"") S %R=4 W @ZAA02GP,$E(R+100,2,3) S %C=%C+3
 S %C=33,%R=5 W @ZAA02GP,"   ",ZAA02G("G1"),ZAA02G("TLC"),X,ZAA02G("HL"),ZAA02G("G0")
 F R=0:1:15 S %R=R+6 W @ZAA02GP,LO,$J(R,2)," ",ZAA02G("G1"),ZAA02G("VL"),ZAA02G("G0")," ",HI F C=0:1:13 S CH=C*16+R+32 W $S(CH=32:"sp ",CH=127:"dl ",1:" "_$TR($C(CH),CA,CB)_" ")
 S %R=24,%C=3 W @ZAA02GP,LO_"Font is    columns by    rows"
FONT S %R=3,%C=1,PROMPT="Enter Font number ",X="",LNG=3,FNC="EX",CHR="" X ^ZAA02GREAD G EXIT:X=""!(FNC="EX") S FNT=X,FNTI=FNT\10*10
 I '$D(^ZAA02GFAXF(FNT)) W *7 G FONT D NFONT G EXIT:'$D(^ZAA02GFAXF(FNT))
 S FR=+^ZAA02GFAXF(FNT),FC=$P(^(FNT),"`",2)
 D BOX S CH=32,%R=23,%C=66,CHP="CHP="_ZAA02GP,@CHP
CHR X ^ZAA02G("ECHO-OFF")
CHR1 S %R=CH-32#16+6,%C=CH\16*3+32,Y=$S(CH=32:"sp",CH=127:"dl",1:" "_$TR($C(CH),CA,CB)_" ") W CHP,CH,"  ",@ZAA02GP,ZAA02G("RON")_Y_ZAA02G("ROF")
CHR2 R X#1 X ZAA02G("T") S:X="" ZAA02GF=$P(ZAA02GY,"\",$A(ZAA02GX,$F(ZAA02GX,ZF))+2) I X]"" W @ZAA02GP,Y S CH=$A(X) G CHR1
 G CCR:ZAA02GF="CR" W @ZAA02GP,Y G @("C"_ZAA02GF):"UK,DK,LK,RK,EX,CR"[ZAA02GF,CHR2
CUK S:CH>32 CH=CH-1 G CHR1
CDK S:CH<255 CH=CH+1 G CHR1
CLK S:CH>47 CH=CH-16 G CHR1
CRK S:CH<240 CH=CH+16 G CHR1
CEX G FONT
CCR D DSP,EDIT G CHR
END K X1,FC,FNT,FTNI,JJ,Y,R,X,ZAA02GF,FONT Q
EDIT S %R=7,%C=4
EDT1 W @ZAA02GP S R=%R-6 R X#1 I X="" X ZAA02G("T") S ZAA02GF=$P(ZAA02GY,"\",$A(ZAA02GX,$F(ZAA02GX,ZF))+2) G:"UK,DK,RK,LK,EX,CR,SE"[$J(ZAA02GF,1) @ZAA02GF W *7 G EDT1
 S FONT(R)=$E(FONT(R),1,%C-4)_$S(X=" ":" ",1:"X")_$E(FONT(R),%C-2,99) W $E(FONT(R),%C-3) G RK
DK S %R=%R+1 S:%R>(FR+6) %R=7 G EDT1
UK S %R=%R-1 S:%R<7 %R=FR+6 G EDT1
RK S %C=%C+1 S:%C>(FC+3) %C=4 G EDT1
LK S %C=%C-1 S:%C<4 %C=FC+3 G EDT1
CR S %C=4 G EDT1
SE S %R=24,%C=40 W @ZAA02GP,"(Reverse,Invert,Flip,Up,Down)-" R X#1 W @ZAA02GP,ZAA02G("CL")
 I X="R" F J=1:1 Q:$D(FONT(J))=0  S FONT(J)=$TR(FONT(J),"01","10")
 I X="U" S A=FONT(1) F J=1:1 S FONT(J)=FONT(J+1) I $D(FONT(J+2))=0 S FONT(J+1)=A Q
 I X="D" X "F J=0:1 Q:'$D(FONT(J+1))" S A=FONT(J) F J=J-1:-1:1 S FONT(J+1)=FONT(J) I J=1 S FONT(J)=A Q
 D DSPP G EDIT
EX S %C=4 I '$D(^ZAA02GFAXT) F JJ=1:1 Q:'$D(^ZAA02GFAXF(FNTI,.3,JJ))  S ^ZAA02GFAXT(^(JJ))=JJ
 S A="",$P(A,$C(1),128)="" K ^ZAA02GFAXF(FNTI\10*10,.7)
 F R=1:1:FR S %R=R+6 W @ZAA02GP,$J("",FC) S X=$TR(FONT(R)," X","01") D CMPL S:'$D(^ZAA02GFAXT(Y)) ^ZAA02GFAXT(Y)=JJ,^ZAA02GFAXF(FNTI,.3,JJ)=Y,JJ=JJ+1 D EX1
 Q
EX1 S:$D(^ZAA02GFAXF(FNT,0,CH,R)) ^(R)=X S:$D(^ZAA02GFAXF(FNT,CH,R)) ^(R)=Y
 S Y=^ZAA02GFAXT(Y),^ZAA02GFAXF(FNT,.1,R)=$E(^ZAA02GFAXF(FNT,.1,R)_A,1,CH-32)_$C(Y#256)_$E(^(R),CH-31+1,255) Q:JJ<256
 I $D(^ZAA02GFAXF(FNT,.2,R)) S ^ZAA02GFAXF(FNT,.2,R)=$E(^ZAA02GFAXF(FNT,.2,R)_A,1,CH-32)_$C(Y\256)_$E(^(R),CH-31+1,255)
 Q
CMPL S Y="",D=1
CMPL1 S (L,M)=$F(X,1,D) S:L=0 L=FC+2 S L=L-D-1 S:L<1 L=0 S Y=Y_$S(Y="":L,M:wht(L),1:","_L),W=D+L
 I W<(FC+1) S L=$F(X,0,W) S:L=0 L=FC+2 S L=L-W-1,Y=Y_$S(Y[",":"",1:",")_blk(L),D=W+L G CMPL1
 Q
DSP K FONT I $D(^ZAA02GFAXF(FNT,.4)) S FC=$A(^ZAA02GFAXF(FNT,.4),CH) D BOX
 F R=1:1:FR S X=$S($D(^ZAA02GFAXF(FNT,.2,R)):$A(^(R),CH-31)*256+$A(^ZAA02GFAXF(FNT,.1,R),CH-31),$D(^ZAA02GFAXF(FNT,.1,R)):$A(^(R),CH-31),1:0) D DSP1 S FONT(R)=$TR(X," X","01")
DSPP S %C=4 F R=1:1:FR S %R=R+6 W @ZAA02GP,$TR(FONT(R),"01"," X")
 Q
DSP1 I X<1 S X=$J("",FC) Q
 S W=0,X1=^ZAA02GFAXF(FNTI,.3,X) I X1?.N S X=$J("",X1) Q
 S X=$P(X1,",",2),ZZ=0,Y="",(Y1,Y2)=0 D DECODE^ZAA02GFAXD S X=$J("",+X1) F K=1:1:$L(Y,"+") S:K#2 X=X_$E("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",1,+$P(Y,"+",K)) S:K#2=0 X=X_$J("",+$P(Y,"+",K))
 S X=X_$J("",$P(X1,",",3)) Q
BOX S %R=24,%C=11 W @ZAA02GP,$J(FC,2) S %C=25 W @ZAA02GP,$J(FR,2) S %C=1 F %R=6:1:23 W @ZAA02GP,$S(%R>6&(%R<(FR+7)):$J(%R-6,2),1:"  "),PAD
 S %C=3,LNG=$S('FC:12,1:FC),TT=6,NT=FR N TW,TE,TM S %C=3,TW=LNG
 S TE=ZAA02G("VL")_$J("",TW)_ZAA02G("VL"),TM="",$P(TM,ZAA02G("HL"),TW+1)="" D 1,2,3
 Q
1 S %R=TT W @ZAA02GP,ZAA02G("G1")_ZAA02G("TLC")_TM_ZAA02G("TRC")_ZAA02G("G0") Q
2 W ZAA02G("G1") F %R=TT+1:1:TT+NT W @ZAA02GP,TE
 W ZAA02G("G0") Q
3 S %R=TT+NT+1 W @ZAA02GP,ZAA02G("G1")_ZAA02G("BLC")_TM_ZAA02G("BRC")_ZAA02G("G0") Q
4 W ZAA02G("G1") F %R=TT+NT:-1:TT+1 W @ZAA02GP,TE
 W ZAA02G("G0") Q
NFONT S %R=24,%C=11,LNG=2,FNC="EX",X="" X ^ZAA02GREAD Q:X=""!(FNC="EX")  S FC=X
 S %R=24,%C=25,LNG=2,FNC="EX",X="" X ^ZAA02GREAD Q:X=""!(FNC="EX")  S FR=X
 S ^ZAA02GFAXF(FNT)=FR_"`"_FC Q
INIT S HI=ZAA02G("HI"),LO=ZAA02G("LO") K ^ZAA02GFAXT
 S (CA,CB)=" " I ZAA02G["VT" S FR="P",TO="VT" D CHARSET^ZAA02GINIT2
 S PAD=$J("",31)
 F I=0:1:32 S wht(I)=^ZAA02GFAXC(0,0,I),blk(I)=^ZAA02GFAXC(0,1,I)
 Q
EXIT K FNT,X,HI,LO,Y,O,X,FONT,CH,wht,blk,PAD Q
ER W *7 Q
