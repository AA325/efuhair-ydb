ZAA02GFAXP1 ;PG&A,ZAA02G-FAX,1.36,PARAMETERS;29NOV95 8:43A;;;10JUN98  11:28
 ;Copyright (C) 1991-1994, Patterson, Gray and Associates Inc.
DIS I NE<22 F I=1:1:NE S TT=$P($T(@DATA+I),";",2,99),PP=$P(TT,"\",2),%R=$P(TT,"\",3),%C=$P(TT,"\",4),SS=$P(TT,"\",5) S:SS=1 PX=PX+1 S X=$P(YY(PX),"\",SS) W @ZAA02GP,ZAA02G("HI"),$J(I_") ",4),ZAA02G("LO"),X,$E(L,6,$P(TT,"\",7)-%C-$L(X)) D:$P(NEW,"\",PP)]"" DSPLY
 I NE>21 F I=1:1:NE S TT=$P($T(@DATA+I),";",2,99),PP=$P(TT,"\",2),%R=$P(TT,"\",3),%C=$P(TT,"\",4),SS=$P(TT,"\",5) S:SS=1 PX=PX+1 S X=$P(YY(PX),"\",SS) W @ZAA02GP,ZAA02G("LO"),X,$E(L,1,$P(TT,"\",7)-%C-$L(X)) D:$P(NEW,"\",PP)]"" DSPLY
 ;         ;
SEL S %R=24,B=$P(Y,"\",4),%C=80-$L(B)\2 W @ZAA02GP F J=1:2:8 W ZAA02G("LO"),$P(B,"*",J),ZAA02G("HI"),$P(B,"*",J+1)
 W " "
 R A#1 X ZAA02G("T") I A="",$E(XX,$F(XX,ZF))="E" S A="Q"
 S:A?1L A=$C($A(A)-32) I A=""!($C(9)_"Q"_$P(B,"*",2)_$P(B,"*",4)'[A) W *7,*8 G SEL
 I A="Q"!(A=$C(9)) S J=-1 G END
 I A'=$P(B,"*",2) S J=1 G END
SELECT S %R=24,I=1,B=$P(Y,"\",5),%C=80-$L(B)\2 W @ZAA02GP,*13,ZAA02G("CL"),@ZAA02GP,ZAA02G("LO"),"( " F J=1:2:8 W $P(B,"*",J),ZAA02G("HI"),$P(B,"*",J+1),ZAA02G("LO")
 W " )",ZAA02G("HI")
 X ^ZAA02G("ECHO-OFF") F J=1:1:NE S TT=$T(@DATA+J),%R=$P(TT,"\",6),%C=$P(TT,"\",7),S=1,RX=0 W @ZAA02GP D RD S:'S $P(NEW,"\",PP)=X I RX=1 S J=J-2 Q:J<0
 I J<0 G END
END X ^ZAA02G("ECHO-ON") K NE,DATA,J,RX,L Q
 ;
DSPLY S %R=$P(TT,"\",6),%C=$P(TT,"\",7) W @ZAA02GP,ZAA02G("HI"),$P(NEW,"\",PP) Q
SET S PP=$P(TT,"\",2),LNG=$P(TT,"\",9),CHR=$P(TT,"\",10),X=$P(NEW,"\",PP),X=X_$J("",LNG-$L(X)),L=1,S=0 Q
 ;
DATA1 ;
 ;\1\3\1\1\3\25\\30\
 ;\2\4\3\2\4\25\\1\YNJ
 ;\4\5\3\4\5\25\\20\
 ;\5\6\3\5\6\25\\1\01
 ;\7\7\1\1\7\25\\30\
 ;\8\8\3\2\8\25\\1\YNJ
 ;\10\9\3\4\9\25\\20\
 ;\11\10\3\5\10\25\\1\01
 ;\13\11\1\1\11\25\\30\
 ;\14\12\3\2\12\25\\1\YNJ
 ;\16\13\3\4\13\25\\20\
 ;\17\14\3\5\14\25\\1\01
 ;\19\15\1\1\15\25\\30\
 ;\20\16\3\2\16\25\\1\YNJ
 ;\22\17\3\4\17\25\\20\
 ;\23\18\3\5\18\25\\1\01
 ;\25\19\1\1\19\25\\30\
 ;\26\20\3\2\20\25\\1\YNJ
 ;\28\21\3\4\21\25\\20\
 ;\29\22\3\5\22\25\\1\01
 ;\31\3\41\1\3\65\\30\
 ;\32\4\43\2\4\65\\1\YNJ
 ;\34\5\43\4\5\65\\20\
 ;\35\6\43\5\6\65\\1\01
 ;\37\7\41\1\7\65\\30\
 ;\38\8\43\2\8\65\\1\YNJ
 ;\40\9\43\4\9\65\\20\
 ;\41\10\43\5\10\65\\1\01
 ;\43\11\41\1\11\65\\30\
 ;\44\12\43\2\12\65\\1\YNJ
 ;\46\13\43\4\13\65\\20\
 ;\47\14\43\5\14\65\\1\01
 ;\49\15\41\1\15\65\\30\
 ;\50\16\43\2\16\65\\1\YNJ
 ;\52\17\43\4\17\65\\20\
 ;\53\18\43\5\18\65\\1\01
 ;\55\19\41\1\19\65\\30\
 ;\56\20\43\2\20\65\\1\YNJ
 ;\58\21\43\4\21\65\\20\
 ;\59\22\43\5\22\65\\1\01
 ;
DATA2 ;
 ;\1\4\5\1\4\40\\38\
 ;\18\5\5\10\5\40\\38
 ;\2\6\5\2\6\40\\38\
 ;\3\7\5\3\7\40\\38\
 ;\12\8\5\4\8\65\\10\
 ;\13\9\5\5\9\65\\10\
 ;\4\10\5\6\10\65\\5\0123456789.
 ;\5\11\5\7\11\65\\5\0123456789.
 ;\6\12\5\8\12\65\\5\0123456789.
 ;\7\13\5\9\13\65\69\4\0123456789.
 ;\8\14\5\1\14\65\\4\0123456789
 ;\9\15\5\2\15\65\\4\0123456789
 ;\10\16\5\3\16\65\\4\0123456789
 ;\11\17\5\4\17\65\\4\0123456789
 ;\14\18\5\5\18\65\\1\0123456789
 ;\15\19\5\6\19\65\\2\0123456789
 ;\16\20\5\7\20\65\\2\0123456789
 ;\17\21\5\8\21\65\\1\WB
 ;
DATA3 ;
 ;\1\6\5\1\6\65\61\1\YNPJS
 ;\2\7\5\2\7\65\62\1\YNJ
 ;\3\8\5\3\8\65\63\1\YNJ
 ;\4\9\5\4\9\65\64\1\YNJ
 ;\5\10\5\5\10\65\65\1\ABCD
 ;\6\12\5\6\12\65\66\1\1479
 ;\7\13\5\7\13\65\67\5\0123456789
 ;
RD R B#1 X ZAA02G("T") G RB:B="" D:S SET G ER:B["\" I CHR'="",CHR'[B G ER
 G ER:L>LNG W B S X=$E(X,1,L-1)_B_$E(X,L+1,99),L=L+1 G RD
RB S E=$E(XX,$F(XX,ZF)) I E'="",$T(@E)'="" G @E
ER W *7 G RD
D D:S SET G RD:L'>1 S L=L-1 W ZAA02G("L") G RD
C D:S SET G RD:L'<LNG W ZAA02G("RT") S L=L+1 G RD
R G:L=1 RD S X=$E(X,1,L-2)_" "_$E(X,L,99),L=L-1 W *8," ",*8 G RD
FUN R A G:A'=1 ER
B S RX=2 G F
A S RX=1 G F
9 S RX=3,J=99
F Q:S  I $E(X)=" " S X=$E(X,2,99) G F
OUT X:X[" " "F I=$L(X):-1:0 I $E(X,I)'="" "" S X=$E(X,1,I) Q" W @ZAA02GP,$J("",$S(NE>22:15,1:LNG)),@ZAA02GP,X K LNG,CHR,L,C,B Q
H D:S SET W $E(X,L+1,99)," " S X=$E(X,1,L-1)_$E(X,L+1,99)_" " W @ZAA02GP,$E(X,1,L-1) G RD
G D:S SET G:$E(X,LNG)'=" " ER W " ",$E(X,L,LNG-1) S X=$E(X,1,L-1)_" "_$E(X,L,LNG-1) W @ZAA02GP,$E(X,1,L-1) G RD
E G 9
Y S HP=$P(TT,"\",8) G ER G ER:HP="" D HELP^ZAA02GFAXH S J=-10,RX=1 Q
5 D:S SET S X=$E(X,0,L-1),CC=%C,%C=%C+L-1 W @ZAA02GP,$J("",LNG-L+1),@ZAA02GP S %C=CC,L=$L(X)+1 K CC G RD
 ;
