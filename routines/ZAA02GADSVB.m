ZAA02GADSVB ;;03:19 PM  15 Sep 1992;
 ;Copyright (C) 1984, Patterson, Gray & Associates, Inc.
 ;
BEG I $D(ZAA02GWPOPT)#2,ZAA02GWPOPT'["OT" W *7 G RET^ZAA02GWPV3
 S A3="Return,Word Search,Change Every,Margin Change,Spelling Check,Word Count,Copy Document,Macros,Import/Export,Dict. Maint,Split Screen,Pagination Preview,Edit Document Descript.,Fix Document,ZAA02G-FAX,Calculator,Quick Print,Monthly Calendar"
 ;    18      19               20            21           22
 S A3=A3_",Account Insert,ADS Dictionary,Print Envelope,ADS Setup"
 D SET I $D(ZAA02G(9)) S A3=@ZAA02G(9)@(37)
 I $O(^ZAA02GWP(110,"")) S A="" F I=1:1 S A=$O(^(A)) Q:A=""  S $P(A3,",",A)=^(A)
 K A4,HP S D=","_A3 I $D(ZAA02GWPOPT)#2,ZAA02GWPOPT?.E1"OT"1N.E S D=$P(D,",",1,2),A=$P(ZAA02GWPOPT,"OT",2),A4="" F I=1:1 S B=$P(A,",",I) Q:'B  S:B>1 D=D_","_$P(A3,",",B),A4=A4_(B-1)_","
 K A3 S LE=25,A=$L(D,",")-1,C=A+1\2,NX=BL+2-C-2,M=NX+1 S:NX<TL NX=TL+1,M=NX
 I ZAA02G("RON")'=""!($D(ZAA02G("a"))=0) W XHI S A1=" "_ZAA02G("RON"),A2=ZAA02G("ROF")_" " G BEG1
 E  S A1=$P(ZAA02G("a"),"`"),A2=$P(ZAA02G("a"),"`",2) F %R=NX-1:1:BL+2 S %C=LE+43 W @ZAA02GP,A2 S %C=LE W @ZAA02GP,A1,$J("",42)
 G BEGX
BEG1 S %R=NX-1,%C=LE,B=ZAA02G("HL"),B=B_B_B_B_B_B_B,B=B_B W @ZAA02GP,ZAA02G("L"),XHI,A1,@ZAA02GP,ZAA02G("G1"),ZAA02G("TLC"),B,B,B,ZAA02G("TRC") F %R=NX:1:BL+1 W @ZAA02GP,ZAA02G("VL"),$J("",42),ZAA02G("VL")
 S %R=BL+2 W @ZAA02GP,ZAA02G("G1"),ZAA02G("BLC"),B,B,B,ZAA02G("BRC"),ZAA02G("G0"),$S(ZAA02G["DTM":"",1:XHI)
BEGX S %C=-$L($P(Y,"\"))+42\2+LE,%R=NX-1 W @ZAA02GP,$P(Y,"\",1) S %R=M-1,%C=LE+3 F I=1:1:C S %R=%R+1 W @ZAA02GP,$P(D,",",I+1)
 S %R=M-1,%C=LE+19 F I=C+1:1:A S %R=%R+1 W @ZAA02GP,$P(D,",",I+1)
 S %R=BL+2,%C=LE+6,I=$S($D(PO):PO,1:0) K PO W @ZAA02GP,$P(Y,"\",2) X ZAA02G("ECHO-OFF")
SEL F I=I:0:A-1 S %R=I#C+M,%C=LE+18-(I<C*16) W @ZAA02GP,A2,$P(D,",",I+2),A1 D AE W @ZAA02GP," ",$P(D,",",I+2)," " G SEL1:E="F",HL:E="Y",EX:E="E" S I=I+$S(E="A":-1,E="D":-C,E="C":C,B'="":A,1:1) Q:I<0
 I B'="" S:B?1L B=$C($A(B)-32) S B=","_B,I=I-A+1 S:D[B I=$S($P(D,",",I+1,99)[B:$L($P($P(D,",",I+1,99),B),",")+I-1,1:$L($P(D,B),",")-1) S B="" G SEL
 I I<0 S I=$S(E="A":A-1,I=-C:A-1,1:A#2-1+I+A) G SEL
 S I=$S(E'="C":0,1:I+1#C) G SEL
SEL1 S B=$S($D(A4):+$P(A4,",",I),1:I) W ZAA02G("ROF"),XHI X ZAA02G("ECHO-ON") G CAL:B=17 K A1,A2,A3,A4,D,LE G SPLIT^ZAA02GWPVA:B=10,MACROS^ZAA02GWPVO:B=7,NPG:",6,9,11,12,13,16,"[(","_B_",")
 ;
SCHG D REFR
BR G RET^ZAA02GWPV3:B=0,WS0^ZAA02GWPV1:B=1,CH0^ZAA02GWPV1:B=2,^ZAA02GWPV4:B=3,^ZAA02GWPV5:B=4,^ZAA02GWPVC:B=5,ZAA02GPC:B=15,FAX:B=14,IE^ZAA02GWPVH:B=8,^ZAA02GADS:B>17&(B<22)
NA S %R=BL+2,%C=1 W @ZAA02GP,$P(Y,"\",3) H 3 S B=0 G SCHG
HL G HELP
EX W ZAA02G("ROF") S B=0 G SCHG
 G SEL
REFR W $S($D(word):XLO,1:XHI) S BOT=TOP,NX=NX-2,%C=LM+2,A=$D(@ZAA02GWPD@(.03)) F %R=TL:1:BL W:%R>NX @ZAA02GP,*13,XCL,@ZAA02GP,$P(^(BOT),XF,4) I %R'=BL S A=BOT,BOT=$O(^(BOT)) S:BOT="" BOT=A+10\1,^(BOT)=A_XFM
 I NX-2<TL D 620^ZAA02GWPV6 G 630
620 S %R=BL+1,A=ZAA02G("HL"),%C=$F(TB,"|")-2+LM W @ZAA02GP,*13,XLO,XCL,@ZAA02GP,ZAA02G("G1"),ZAA02G("BLC") F I=%C:1:RM+LM+1 W A
 W ZAA02G("BRC") S A=$S(ZAA02G["VT2":$C(96),1:ZAA02G("X")) F I=1:0 S I=$F(TB,"X",I) Q:'I  S %C=I+LM-1 W @ZAA02GP,A
630 S %R=BL+2,%C=1 W ZAA02G("G0"),@ZAA02GP,XCL K NX Q
AE I $D(MC) S B=$E(MC),MC=$E(MC,2,255),E="" S:$A(MC)=1 E=$P(MC,$C(1),2),MC=$P(MCM,$C(1),3,99) S:B=$C(1) B="",E=$P(MC,$C(1)),MC=$P(MC,$C(1),2,99) W B Q:MC'=""  S MCC=MCC+1 S:$D(@MCG@(MCC)) MC=@MCG@(MCC) K:MC="" MC,MCG I $D(@ZAA02GWPD@(0))'=3 Q
 R B#1 X ZAA02G("T") S E=$E(XX,$F(XX,ZF)) Q
 ;
NPG I B=13,ZAA02GWPD'["ZAA02GWP(DIR,DOC)" D FX1^ZAA02GWPM2 S B=0 G SCHG
 X:MG>76 $P(^ZAA02G(.1,ZAA02G,7),"\",2) W:SC @ZAA02G("CSR") W ZAA02G("F")
 I B=9 D DICT G NPGE
 I B=16 D PRINT G NPGE
 I B=6 D COPY G NPGE
 I B=11 D BEG2^ZAA02GWPPA G NPGE
 I B=12 D EDIT G NPGE
 I B=13 D ^ZAA02GWPM2
NPGE S A=$D(@ZAA02GWPD@(10)) W ZAA02G("F"),ZAA02G("ROF"),XLO G 610^ZAA02GWPV6:$D(W)<2,SPLITD^ZAA02GWPVA
DICT N (ZAA02G,ZAA02GP,T) D ^ZAA02GWPS1 Q
HELP S HP=$P("1,40,29,54,41,16,80,45,81,82,47,83,89,84,85,1,87,88",",",I+1),PO=I D:HP'=1 HLPR^ZAA02GWPV9 G BEG
PRINT S A=$D(@ZAA02GWPD@(0)) N (DIR,DOC,ZAA02G,T,XSL,XF,ZAA02GP,ZAA02GWPD,XX)
 I ZAA02GWPD["ZAA02GWP(" L ^ZAA02GWP(DIR,DOC) D SCAN^ZAA02GWPVD
 D ^ZAA02GWPP8 H 1 Q
 ;
COPY N (DIR,DOC,ZAA02G,ZAA02GP) D TO^ZAA02GWPOC Q
EDIT N (XX,WPR,ZAA02G,ZAA02GP,DOC,DIR,ZAA02GWPD,NM) D ^ZAA02GWPOA S:DOC="" DOC=+$P(NM,"-",2) S NM=$E(DIR_"-"_DOC_"  "_$P(@ZAA02GWPD,"\")_$J("",20),1,20) Q
FAX S NX=TL+1 G:$D(^ZAA02GFAXC)=0 NA D FAX1 S B=0 G SCHG
FAX1 N (ZAA02G,ZAA02GP,DIR,DOC,ZAA02GWPD,BL,FAXTO,FAXFROM,FAXTOF,FAXORG) D ^ZAA02GFAXQ Q
ZAA02GPC D ^ZAA02GWPVQ S NX=BL-9 D REFR
ZAA02GPC1 S %R=ZAA02G("R"),%C=1 W @ZAA02GP,XCL,XLO,$P(Y,"\",4),XHI," ",RESULT," ",XLO,$P(Y,"\",5)," " H 3
 S HOT="HOT1^ZAA02GWPVB "_RESULT,B=0 K RESULT G RET^ZAA02GWPV3
HOT1 D SET^@WPR S B=$P(HOT," ",2,99),CC=CC+$L(B),%=$E(%_$J("",250-$L(%)),1,W-1)_B_$E(%,W+$L(B),255) W B D ST^@WPR G RET^@WPR
CAL D ^ZAA02GWPVI K A1,LE,A2,A3,A4 S B=0 G SCHG
 ;
SET S Y=$S($D(ZAA02G(9)):@ZAA02G(9)@(38),1:"OTHER OPTIONS\(select option...press RETURN)\(option not available)\The value\has been loaded into the REPEAT KEY\") Q
