ZAA02GSCMPW ;PG&A,ZAA02G-MTS,1.20,SYSTEM SETUP;18NOV94  01:15;;;08AUG2003  15:35
C ;Copyright (C) 1995, Patterson, Gray & Associates, Inc.
 I $D(ZAA02G("ECHO-ON"))+$D(XX)'=2 K (ZAA02G,ZAA02GP,ZAA02GPWD,TEST,CLN,ZAA02GID) D SETUP^ZAA02GWP S ZAA02G("MENU")=0
BEG D HEAD
 S %R=21,%C=4 W ZAA02G("LO"),@ZAA02GP,"Version ",$P($T(ZAA02GSCMPW),",",3),"  ",$P($T(C),";",2)
 D:'$D(ZAA02GSCR) DATABASE
 D PARAM^ZAA02GSCRPW S NE=0 D PASSWD I $D(TRANS) S @ZAA02GSCR@(111,$I)=TRANS D BEG1
 Q
 ;
BEG1 K ^ZAA02GTWP("~",$I) D DATE^ZAA02GSCRER S ^ZAA02GTWP("~",$I,0,1)=DT I $D(@ZAA02GSCR@("PARAM","CONFIG")) X ^("CONFIG")
 Q
PASSWD I $D(ZAA02GPWD) D ZAA02GPWD Q:'$D(ZAA02GPWD)  S X=ZAA02GPWD G PASSWD1
 I $D(@ZAA02GSCR@("PARAM","CODE"))=0!($G(TEST)="?") S TRANS="xxx",TRTYPE="3\Y\xxx\N\N" Q
 D PASSWDH S %R=4,%C=32 W @ZAA02GP,ZAA02G("HI"),"Enter User Code" X ZAA02G("ECHO-OFF") S %R=6,%C=33,X="" W @ZAA02GP R B:0 F J=1:1:12 R B#1:3000 Q:B=""  S:B?1U B=$c($a(B)+32) S X=X_B W " "
 X ZAA02G("ECHO-ON")
PASSWD1 Q:X=""  I $D(@ZAA02GSCR@("PARAM","CODE",X)) S X=^(X) I $D(@ZAA02GSCR@("PARAM","USER",X)) S TRANS=X,TRTYPE=$TR($P(^(X),"\",4),"NYM",123)_"\"_$P(^(X),"\",7,9)_"\"_$P(^(X),"\",12,13) Q
 S %R=8,%C=31 W @ZAA02GP,"Invalid User Code" S NE=NE+1 G PASSWD:NE<4 Q
PASSWDH W ZAA02G("LO") D:$D(@ZAA02GSCR@(102,ZAA02G,1))=0 ^ZAA02GSCRINT F I=1:1 Q:$D(^(I))=0  W ^(I)
 Q
S S TEST="?" D ZAA02GSCMPW S TEST="" Q
 ;
 ;
DATABASE S ZAA02GSCR=$S($D(^ZAA02GSCRR):"^ZAA02GSCRR",$G(^ZAA02GSCR("PARAM","DATABASE"))]"":^("DATABASE"),1:"^ZAA02GSCR") I '$D(ZAA02GPWD),$D(@ZAA02GSCR),'$D(@ZAA02GSCR@("PARAM","CODE")) S ZAA02GPWD="xxx"
 Q
HEAD W ZAA02G("F") S %R=1,%C=2 I $D(ZAA02G("a"))=0 W ZAA02G("LO"),@ZAA02GP,ZAA02G("RON")," P ",ZAA02G("RT")," G ",ZAA02G("RT")," & ",ZAA02G("RT")," A " S %C=70 W @ZAA02GP,"  ZAA02G-MTS  ",ZAA02G("ROF"),!
 E  S A=$P(ZAA02G("a"),"`"),I=$P(ZAA02G("a"),"`",2),%C=18 W @ZAA02GP,I,*13," ",ZAA02G("HI"),A,"P ",I,A,"G ",I,A,"& ",I,A,"A ",I S %C=71 W @ZAA02GP,A,"ZAA02G-MTS ",I,!
 W ZAA02G("G1") S J=ZAA02G("HL"),J=J_J_J_J F I=1:1:20 W J
 W ZAA02G("G0") Q
 ;
 ;  SETUP FOR OUTSIDE INQUIRY OPTIONS
 ;
SETUP D:$D(ZAA02G("ECHO-ON"))+$D(XX)'=2 SETUP^ZAA02GWP S ZAA02G("MENU")=0 D DATABASE,PARAM
 Q
 ;
ZAA02GPWD S ZAA02GPWD=$TR(ZAA02GPWD,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
 I $D(@ZAA02GSCR@("PARAM","CODE",ZAA02GPWD))=0 S Y="20,14\RLH\1\\\"_ZAA02GPWD_" - PASSWORD NOT VALID WITH ZAA02G-MTS",Y(0)="\EX\" D ^ZAA02GPOP K ZAA02GPWD
 Q
